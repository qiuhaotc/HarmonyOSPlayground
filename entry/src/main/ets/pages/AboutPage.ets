import router from '@ohos.router';
import common from '@ohos.app.ability.common';
import { Want } from '@kit.AbilityKit';
import { BusinessError } from '@ohos.base';

/**
 * å…³äºŽé¡µé¢
 */
@Entry
@Component
struct AboutPage {
  build() {
    Column() {
      // æ ‡é¢˜æ 
      this.buildTitleBar();

      // å†…å®¹åŒºåŸŸ
      Scroll() {
        Column() {
          // åº”ç”¨å›¾æ ‡å’Œåç§°
          Column() {
            Text('ðŸ’°')
              .fontSize(64)
              .margin({ top: 40 })

            Text('è®°è´¦æœ¬')
              .fontSize(24)
              .fontWeight(FontWeight.Bold)
              .fontColor($r('app.color.text_primary'))
              .margin({ top: 16 })

            Text('Version 1.0.0')
              .fontSize(14)
              .fontColor($r('app.color.text_tertiary'))
              .margin({ top: 8 })
          }
          .width('100%')
          .margin({ bottom: 40 })

          // åº”ç”¨ç®€ä»‹
          Column() {
            Text('åº”ç”¨ç®€ä»‹')
              .fontSize(16)
              .fontWeight(FontWeight.Medium)
              .fontColor($r('app.color.text_primary'))
              .width('100%')
              .padding({ left: 16, right: 16 })
              .margin({ bottom: 12 })

            Text('ä¸€æ¬¾ç®€æ´å®žç”¨çš„è®°è´¦åº”ç”¨ï¼Œå¸®åŠ©æ‚¨è½»æ¾ç®¡ç†æ—¥å¸¸æ”¶æ”¯ï¼Œæ¸…æ™°æŽŒæ¡è´¢åŠ¡çŠ¶å†µã€‚')
              .fontSize(14)
              .fontColor($r('app.color.text_secondary'))
              .lineHeight(22)
              .width('100%')
              .padding({ left: 16, right: 16 })
              .borderRadius(8)
              .padding(16)
              .margin({ left: 12, right: 12 })
          }
          .width('100%')
          .margin({ bottom: 24 })

          // åŠŸèƒ½ç‰¹æ€§
          Column() {
            Text('åŠŸèƒ½ç‰¹æ€§')
              .fontSize(16)
              .fontWeight(FontWeight.Medium)
              .fontColor($r('app.color.text_primary'))
              .width('100%')
              .padding({ left: 16, right: 16 })
              .margin({ bottom: 12 })

            Column({ space: 8 }) {
              this.buildFeatureItem('âœ…', 'æ”¯æŒæ”¶å…¥å’Œæ”¯å‡ºè®°å½•')
              this.buildFeatureItem('ðŸ“Š', 'å¤šç»´åº¦ç»Ÿè®¡åˆ†æž')
              this.buildFeatureItem('ðŸ·ï¸', 'å¤šç§åˆ†ç±»æ ‡ç­¾')
              this.buildFeatureItem('ðŸ“…', 'æŒ‰å¹´æœˆç­›é€‰è´¦å•')
              this.buildFeatureItem('ðŸ’¾', 'æœ¬åœ°æ•°æ®å­˜å‚¨')
            }
            .width('100%')
            .borderRadius(8)
            .padding(16)
            .margin({ left: 12, right: 12 })
          }
          .width('100%')
          .margin({ bottom: 24 })

          // GitHub ä»“åº“
          Column() {
            Text('å¼€æºé¡¹ç›®')
              .fontSize(16)
              .fontWeight(FontWeight.Medium)
              .fontColor($r('app.color.text_primary'))
              .width('100%')
              .padding({ left: 16, right: 16 })
              .margin({ bottom: 12 })

            Row() {
              Column({ space: 4 }) {
                Row() {
                  Text('ðŸ”— ')
                    .fontSize(16)
                  Text('GitHub ä»“åº“')
                    .fontSize(14)
                    .fontWeight(FontWeight.Medium)
                    .fontColor($r('app.color.text_primary'))
                }

                Text('https://github.com/qiuhaotc/HarmonyOSPlayground')
                  .fontSize(12)
                  .maxLines(2)
              }
              .alignItems(HorizontalAlign.Start)
              .layoutWeight(1)

              Text('è®¿é—®')
                .fontSize(14)
                .borderRadius(4)
                .padding({ left: 16, right: 16, top: 6, bottom: 6 })
            }
            .width('100%')
            .padding(16)
            .borderRadius(8)
            .margin({ left: 12, right: 12 })
            .onClick(() => {
              const wantInfo: Want = {
                action: 'ohos.want.action.viewData',
                uri: 'https://github.com/qiuhaotc/HarmonyOSPlayground' // æ›¿æ¢ä¸ºå®žé™…é“¾æŽ¥
              };

              const context = this.getUIContext().getHostContext() as common.UIAbilityContext;

              context.startAbility(wantInfo)
                .catch((err: BusinessError) => {
                    console.error('æ‰“å¼€é“¾æŽ¥å¤±è´¥:', err);
                    // å¦‚æžœå¤±è´¥ï¼Œæ˜¾ç¤ºæç¤º
                    this.getUIContext().getPromptAction().showToast({
                      message: "è¯·æ‰‹åŠ¨è®¿é—® GitHub ä»“åº“",
                      duration: 2000
                    });
                });
            })
          }
          .width('100%')
          .margin({ bottom: 24 })

          // æŠ€æœ¯æ ˆ
          Column() {
            Text('æŠ€æœ¯æ ˆ')
              .fontSize(16)
              .fontWeight(FontWeight.Medium)
              .fontColor($r('app.color.text_primary'))
              .width('100%')
              .padding({ left: 16, right: 16 })
              .margin({ bottom: 12 })

            Column({ space: 8 }) {
              this.buildTechItem('ArkTS', 'å¼€å‘è¯­è¨€')
              this.buildTechItem('ArkUI', 'UIæ¡†æž¶')
              this.buildTechItem('RelationalStore', 'æ•°æ®å­˜å‚¨')
            }
            .width('100%')
            .borderRadius(8)
            .padding(16)
            .margin({ left: 12, right: 12 })
          }
          .width('100%')
          .margin({ bottom: 40 })

          // ç‰ˆæƒä¿¡æ¯
          Text('Â© 2025 è®°è´¦æœ¬åº”ç”¨')
            .fontSize(12)
            .fontColor($r('app.color.text_tertiary'))
            .margin({ bottom: 20 })
        }
        .width('100%')
      }
      .layoutWeight(1)
      .scrollBar(BarState.Auto)
    }
    .width('100%')
    .height('100%')
    .backgroundColor($r('app.color.page_background'))
  }

  @Builder
  buildTitleBar() {
    Row() {
      Text('è¿”å›ž')
        .fontSize(16)
        .fontColor($r('app.color.text_primary'))
        .onClick(() => {
          router.back();
        })

      Text('å…³äºŽ')
        .fontSize(18)
        .fontWeight(FontWeight.Bold)
        .fontColor($r('app.color.text_primary'))
        .layoutWeight(1)
        .textAlign(TextAlign.Center)

      Text('   ')
        .fontSize(16)
    }
    .width('100%')
    .height(56)
    .padding({ left: 16, right: 16 })
  }

  @Builder
  buildFeatureItem(icon: string, text: string) {
    Row() {
      Text(icon)
        .fontSize(16)
        .margin({ right: 8 })

      Text(text)
        .fontSize(14)
        .fontColor($r('app.color.text_secondary'))
    }
    .width('100%')
    .padding({ top: 4, bottom: 4 })
  }

  @Builder
  buildTechItem(name: string, description: string) {
    Row() {
      Column({ space: 2 }) {
        Text(name)
          .fontSize(14)
          .fontWeight(FontWeight.Medium)
          .fontColor($r('app.color.text_primary'))

        Text(description)
          .fontSize(12)
          .fontColor($r('app.color.text_tertiary'))
      }
      .alignItems(HorizontalAlign.Start)
      .layoutWeight(1)
    }
    .width('100%')
    .padding({ top: 4, bottom: 4 })
  }
}
