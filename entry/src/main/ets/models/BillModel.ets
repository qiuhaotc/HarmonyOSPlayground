/**
 * è´¦å•ç±»å‹æšä¸¾
 */
export enum BillType {
  INCOME = 'income',  // æ”¶å…¥
  EXPENSE = 'expense' // æ”¯å‡º
}

/**
 * è´¦å•åˆ†ç±»
 */
export class BillCategory {
  id: number = 0;
  name: string = '';
  type: BillType = BillType.EXPENSE;
  icon: string = '';
  color: string = '';

  constructor(id: number, name: string, type: BillType, icon: string = '', color: string = '') {
    this.id = id;
    this.name = name;
    this.type = type;
    this.icon = icon;
    this.color = color;
  }
}

/**
 * è´¦å•æ•°æ®æ¨¡å‹
 */
export class BillModel {
  id?: number; // æ•°æ®åº“è‡ªå¢ID
  amount: number = 0; // é‡‘é¢
  type: BillType = BillType.EXPENSE; // ç±»å‹
  category: string = ''; // åˆ†ç±»
  date: string = ''; // æ—¥æœŸ æ ¼å¼: YYYY-MM-DD
  time: string = ''; // æ—¶é—´ æ ¼å¼: HH:mm:ss
  note: string = ''; // å¤‡æ³¨
  createTime: string = ''; // åˆ›å»ºæ—¶é—´

  constructor(amount: number, type: BillType, category: string, date: string, time: string, note: string = '') {
    this.amount = amount;
    this.type = type;
    this.category = category;
    this.date = date;
    this.time = time;
    this.note = note;
    this.createTime = new Date().toISOString();
  }

  // è·å–å¹´æœˆ æ ¼å¼: YYYY-MM
  getYearMonth(): string {
    return this.date.substring(0, 7);
  }

  // è·å–å¹´ä»½
  getYear(): string {
    return this.date.substring(0, 4);
  }

  // è·å–æœˆä»½
  getMonth(): string {
    return this.date.substring(5, 7);
  }
}

/**
 * è´¦å•ç»Ÿè®¡æ•°æ®
 */
export class BillStatistics {
  totalIncome: number = 0; // æ€»æ”¶å…¥
  totalExpense: number = 0; // æ€»æ”¯å‡º
  balance: number = 0; // ç»“ä½™
  categoryStats: Map<string, number> = new Map(); // æŒ‰åˆ†ç±»ç»Ÿè®¡

  constructor() {
    this.totalIncome = 0;
    this.totalExpense = 0;
    this.balance = 0;
    this.categoryStats = new Map();
  }
}

/**
 * é¢„å®šä¹‰çš„è´¦å•åˆ†ç±»
 */
export const DEFAULT_CATEGORIES: BillCategory[] = [
  // æ”¯å‡ºåˆ†ç±»
  new BillCategory(1, 'é¤é¥®', BillType.EXPENSE, 'ğŸ¥¢', '#FF6B6B'),
  new BillCategory(2, 'äº¤é€š', BillType.EXPENSE, 'ğŸš—', '#4ECDC4'),
  new BillCategory(3, 'è´­ç‰©', BillType.EXPENSE, 'ğŸ›ï¸', '#45B7D1'),
  new BillCategory(4, 'å¨±ä¹', BillType.EXPENSE, 'ğŸ¬', '#96CEB4'),
  new BillCategory(5, 'åŒ»ç–—', BillType.EXPENSE, 'ğŸ’Š', '#FFEAA7'),
  new BillCategory(6, 'ä½æˆ¿', BillType.EXPENSE, 'ğŸ ', '#DFE6E9'),
  new BillCategory(7, 'æ•™è‚²', BillType.EXPENSE, 'ğŸ“š', '#74B9FF'),
  new BillCategory(8, 'é€šè®¯', BillType.EXPENSE, 'ğŸ“±', '#A29BFE'),
  new BillCategory(9, 'å…¶ä»–', BillType.EXPENSE, 'ğŸ“', '#B2BEC3'),
  
  // æ”¶å…¥åˆ†ç±»
  new BillCategory(10, 'å·¥èµ„', BillType.INCOME, 'ğŸ’°', '#00B894'),
  new BillCategory(11, 'å¥–é‡‘', BillType.INCOME, 'ğŸ', '#00CEC9'),
  new BillCategory(12, 'æŠ•èµ„', BillType.INCOME, 'ğŸ“ˆ', '#6C5CE7'),
  new BillCategory(13, 'å…¼èŒ', BillType.INCOME, 'ğŸ’¼', '#FDCB6E'),
  new BillCategory(14, 'å…¶ä»–', BillType.INCOME, 'ğŸ“', '#B2BEC3'),
];

/**
 * è·å–æ”¯å‡ºåˆ†ç±»åˆ—è¡¨
 */
export function getExpenseCategories(): BillCategory[] {
  return DEFAULT_CATEGORIES.filter(cat => cat.type === BillType.EXPENSE);
}

/**
 * è·å–æ”¶å…¥åˆ†ç±»åˆ—è¡¨
 */
export function getIncomeCategories(): BillCategory[] {
  return DEFAULT_CATEGORIES.filter(cat => cat.type === BillType.INCOME);
}

/**
 * æ ¹æ®ç±»å‹è·å–åˆ†ç±»åˆ—è¡¨
 */
export function getCategoriesByType(type: BillType): BillCategory[] {
  return DEFAULT_CATEGORIES.filter(cat => cat.type === type);
}
